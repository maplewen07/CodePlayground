## 目标
1. 修改程序使其在缺少真实API密钥时能够运行（使用模拟客户端）
2. 将单体脚本拆分为多个模块，提高代码可维护性
3. 测试拆分后的程序能否正常启动和执行

## 步骤

### 阶段一：实现模拟运行支持
1. **创建模拟客户端类** `MockOKXClient`：
   - 继承自 `OKXClient` 或实现相同接口
   - 重写 `_request` 方法以返回虚拟数据，避免实际网络请求
   - 为关键方法（如 `get_candles`、`get_balance`、`place_order` 等）提供虚拟实现
   - 虚拟数据应足够真实以触发策略逻辑（例如，生成模拟K线数据、余额等）

2. **修改主程序入口** `main()`：
   - 检查环境变量 `USE_MOCK` 或虚拟密钥的存在
   - 如果启用模拟模式，则使用 `MockOKXClient`；否则使用真实 `OKXClient`
   - 确保模拟模式下不会因认证错误而崩溃

3. **虚拟数据生成**：
   - 为 `get_candles` 生成模拟的BTC/USDT小时K线数据（例如，使用正弦波或随机漫步）
   - 为 `get_balance` 返回固定的虚拟余额（例如，10 BTC, 10000 USDT）
   - 为 `place_order` 和 `place_algo_order` 返回成功的模拟响应

### 阶段二：模块化拆分
将 `okx_spot_trend_bot.py` 拆分为以下模块：

1. **config.py**：`BotConfig` 数据类
2. **okx_client.py**：`OKXClient` 类和 `MockOKXClient` 类
3. **indicators.py**：`ema()` 和 `atr()` 函数
4. **llm_filter.py**：`LLMFilter` 类
5. **state_manager.py**：`load_state()` 和 `save_state()` 函数
6. **trend_bot.py**：`TrendBot` 类
7. **main.py**：`sleep_to_next_hour()` 和 `main()` 函数，以及 `if __name__ == "__main__"` 入口

**导入关系**：
- `main.py` 导入其他所有模块
- `trend_bot.py` 导入 `config`、`okx_client`、`indicators`、`llm_filter`、`state_manager`
- 其他模块保持独立

### 阶段三：测试运行
1. **设置虚拟环境变量**：
   - 设置 `OKX_API_KEY=dummy`、`OKX_API_SECRET=dummy`、`OKX_API_PASSPHRASE=dummy`
   - 设置 `USE_MOCK=1` 以启用模拟模式

2. **运行主程序**：
   - 执行 `python main.py`，观察程序是否启动并进入每小时循环
   - 验证日志输出是否显示策略逻辑（如指标计算、虚拟下单等）
   - 确保程序不会因异常而崩溃

3. **验证模块导入**：
   - 确保所有模块能正确导入，无循环导入错误
   - 确保 `state.json` 文件在程序目录下正确创建和更新

### 预期结果
- 程序能够在没有真实API密钥的情况下启动并运行
- 模块化结构清晰，每个模块职责单一
- 模拟客户端提供足够的数据供策略逻辑执行，方便后续开发和测试

## 注意事项
- 保持原有功能不变，仅添加模拟模式和模块化结构
- 模拟数据应避免过于复杂，但需覆盖策略的主要分支
- 确保拆分后的模块间导入路径正确（使用相对导入或包结构）
